"use strict";
/*!
 * Copyright 2019 acrazing <joking.young@gmail.com>. All rights reserved.
 * @since 2019-04-12 16:56:21
 */
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const ink_1 = require("ink");
const React = tslib_1.__importStar(require("react"));
const react_1 = require("react");
const GomokuStore_1 = require("../store/GomokuStore");
const UserStore_1 = require("../store/UserStore");
const api_1 = require("../utils/service/api");
class LoadingScene extends react_1.PureComponent {
    componentDidMount() {
        return tslib_1.__awaiter(this, void 0, void 0, function* () {
            if (!UserStore_1.User.userId) {
                GomokuStore_1.Gomoku.push('Login');
                return;
            }
            try {
                api_1.API.config({ token: UserStore_1.User.token });
                const user = yield api_1.userGet({});
                UserStore_1.User.login({ token: UserStore_1.User.token, user });
                yield GomokuStore_1.Gomoku.initSocket();
                GomokuStore_1.Gomoku.push('RoomList');
            }
            catch (e) {
                GomokuStore_1.Gomoku.push('Login');
            }
        });
    }
    render() {
        return (React.createElement(ink_1.Box, null,
            React.createElement(ink_1.Text, { bold: true }, "Loading...")));
    }
}
exports.LoadingScene = LoadingScene;
